apiVersion: v1
kind: ConfigMap
metadata:
  name: neo4j-config
data:
  # Neo4j Configuration
  NEO4J_AUTH: "neo4j/$(NEO4J_PASSWORD)"
  NEO4J_PLUGINS: '["apoc"]'

  # Memory Configuration
  NEO4J_dbms_memory_heap_initial__size: "512m"
  NEO4J_dbms_memory_heap_max__size: "2G"
  NEO4J_dbms_memory_pagecache_size: "1G"

  # Network Configuration
  NEO4J_dbms_default__listen__address: "0.0.0.0"
  NEO4J_dbms_connector_bolt_listen__address: "0.0.0.0:7687"
  NEO4J_dbms_connector_http_listen__address: "0.0.0.0:7474"
  NEO4J_dbms_connector_https_listen__address: "0.0.0.0:7473"

  # Connector Configuration
  NEO4J_dbms_connector_bolt_advertised__address: "neo4j-0.neo4j:7687"
  NEO4J_dbms_connector_http_advertised__address: "neo4j-0.neo4j:7474"
  NEO4J_dbms_connector_https_advertised__address: "neo4j-0.neo4j:7473"

  # Transaction Configuration
  NEO4J_dbms_transaction_timeout: "60s"
  NEO4J_dbms_transaction_concurrent_maximum: "1000"
  NEO4J_dbms_transaction_max__age: "1000s"

  # Database Configuration
  NEO4J_dbms_active__database: "neo4j"
  NEO4J_dbms_default__database: "neo4j"

  # Backup Configuration
  NEO4J_dbms_backup_enabled: "true"
  NEO4J_dbms_backup_listen__address: "0.0.0.0:6362"

  # Logging Configuration
  NEO4J_dbms_logs_debug_level: "INFO"
  NEO4J_dbms_logs_gc_enabled: "true"
  NEO4J_dbms_logs_gc_rotation_keep__number: "5"
  NEO4J_dbms_logs_gc_rotation_size: "20m"
  NEO4J_dbms_logs_debug_rotation_keep__number: "7"
  NEO4J_dbms_logs_debug_rotation_size: "20m"
  NEO4J_dbms_logs_query_enabled: "true"
  NEO4J_dbms_logs_query_threshold: "1000ms"
  NEO4J_dbms_logs_query_rotation_keep__number: "7"
  NEO4J_dbms_logs_query_rotation_size: "20m"
  NEO4J_dbms_logs_security_log_enabled: "true"

  # Monitoring Configuration
  NEO4J_dbms_metrics_enabled: "true"
  NEO4J_dbms_metrics_jvm_enabled: "true"
  NEO4J_dbms_metrics_prometheus_enabled: "true"
  NEO4J_dbms_metrics_prometheus_endpoint: "0.0.0.0:2004"

  # Security Configuration
  NEO4J_dbms_security_procedures_unrestricted: "apoc.*"
  NEO4J_dbms_security_procedures_allowlist: "apoc.*"

  # Performance Configuration
  NEO4J_dbms_connector_bolt_thread__pool__max__size: "400"
  NEO4J_dbms_connector_bolt_thread__pool__min__size: "5"
  NEO4J_dbms_connector_bolt_thread__pool__keep__alive: "5m"

  # Query Configuration
  NEO4J_dbms.cypher.min__replan__interval: "5s"
  NEO4J_dbms.cypher.replan__interval: "30s"
  NEO4J_dbms.query_cache_size: "200"

  # Index Configuration
  NEO4J_dbms.index_background__failed__enabled: "true"
  NEO4J_dbms.index_background__recovery_enabled: "true"

  # Replication (if using Neo4j Enterprise)
  NEO4J_causal__clustering_expected__core__cluster__size: "3"
  NEO4J_causal__clustering_initial__discovery__members: "neo4j-0.neo4j:5000,neo4j-1.neo4j:5000,neo4j-2.neo4j:5000"
  NEO4J_causal__clustering_discovery__advertised__address: "0.0.0.0:5000"
  NEO4J_causal__clustering_transaction__advertised__address: "0.0.0.0:6000"
  NEO4J_causal__clustering_raft__advertised__address: "0.0.0.0:7000"
